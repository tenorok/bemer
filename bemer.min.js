(function(a){var b=modules=define=a;!function(a){function c(a){var b=k(a);if(q)for(var c,d=0;c=t[d++];)a.hasOwnProperty(c)&&b.push(c);return b}function d(a,b,d){for(var e,f,h=c(d),i=0,j=h.length;j>i;)"__self"!==(e=h[i++])&&(f=d[e],b[e]=o(f)&&(!g||f.toString().indexOf(".__base")>-1)?function(b,c){var d=a[b]||p;return function(){var a=this.__base;this.__base=d;var b=c.apply(this,arguments);return this.__base=a,b}}(e,f):f)}function e(a,b){for(var c,d=1;c=a[d++];)b?o(c)?f.self(b,c.prototype,c):f.self(b,c):b=o(c)?f(a[0],c.prototype,c):f(a[0],c);return b||a[0]}function f(){var a=arguments,b=n(a[0]),c=b||o(a[0]),f=c?b?e(a[0]):a[0]:h,g=a[c?1:0]||{},i=a[c?2:1],k=g.__constructor||c&&f.prototype.__constructor?function(){return this.__constructor.apply(this,arguments)}:function(){};if(!c)return k.prototype=g,k.prototype.__self=k.prototype.constructor=k,l(k,i);l(k,f);var m=f.prototype,p=k.prototype=j(m);return p.__self=p.constructor=k,g&&d(m,p,g),i&&d(f,k,i),k}var g=function(){"_"}.toString().indexOf("_")>-1,h=function(){},i=Object.prototype.hasOwnProperty,j=Object.create||function(a){var b=function(){};return b.prototype=a,new b},k=Object.keys||function(a){var b=[];for(var c in a)i.call(a,c)&&b.push(c);return b},l=function(a,b){for(var c in b)i.call(b,c)&&(a[c]=b[c]);return a},m=Object.prototype.toString,n=Array.isArray||function(a){return"[object Array]"===m.call(a)},o=function(a){return"[object Function]"===m.call(a)},p=function(){},q=!0,r={toString:""};for(var s in r)r.hasOwnProperty(s)&&(q=!1);var t=q?["toString","valueOf"]:null;f.self=function(){var a=arguments,b=n(a[0]),c=b?e(a[0],a[0][0]):a[0],f=a[1],g=a[2],h=c.prototype;return f&&d(h,h,f),g&&d(c,c,g),c};var u=!0;"object"==typeof b&&(module.exports=f,u=!1),"object"==typeof modules&&(modules.define("inherit",function(a){a(f)}),u=!1),"function"==typeof define&&(define(function(a,b,c){c.exports=f}),u=!1),u&&(a.inherit=f)}(this)}).call(this),/*!
 * @file Template engine. BEMJSON to HTML processor.
 * @copyright 2014 Artem Kurbatov, tenorok.ru
 * @license MIT license
 * @version 0.1.2
 * @date 1 June 2014
 */
function(a,b){{var c={"export":function(b,c){return"object"==typeof exports?module.exports[b]=c:a[b]=c}},d=a.inherit,e=function(){function a(){}return a.class={string:"[object String]",number:"[object Number]","boolean":"[object Boolean]",array:"[object Array]",object:"[object Object]",func:"[object Function]",date:"[object Date]",regexp:"[object RegExp]",arguments:"[object Arguments]",error:"[object Error]"},a.toString=Object.prototype.toString,a.reNative=RegExp("^"+String(a.toString).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$"),a.string=function(){return a._primitive(arguments,"string")},a.number=function(){return!a.nan.apply(this,arguments)&&a._primitive(arguments,"number")},a.integer=function(){return a.number.apply(this,arguments)&&a._every(arguments,function(){return this%1===0})},a.float=function(){return a.number.apply(this,arguments)&&a._every(arguments,function(){return this%1!==0})},a.nan=function(){return a._every(arguments,function(b){return"number"==typeof b&&isNaN(b)&&!a.undefined(b)})},a.boolean=function(){return a._primitive(arguments,"boolean")},a.null=function(){return a._every(arguments,function(a){return null===a})},a.undefined=function(){return a._every(arguments,function(a){return"undefined"==typeof a})},a.primitive=function(){return a._every(arguments,function(b){return a.string(b)||a.number(b)||a.nan(b)||a.boolean(b)||a.null(b)||a.undefined(b)})},a.array=function(){return a._every(arguments,function(){return Array.isArray(this)})},a.argument=function(){return a._every(arguments,function(){return"object"==typeof this&&"number"==typeof this.length&&a._isToString(this,"arguments")||!1})},a.function=function(){return a._every(arguments,function(){return"function"==typeof this})},a.native=function(){return a._every(arguments,function(){return a.function(this)&&a.reNative.test(this)})},a.map=function(){return a._every(arguments,function(){if(!a._isToString(this,"object")||a.argument(this))return!1;if(a.native(this.valueOf)){var b=Object.getPrototypeOf(this.valueOf);if(b){var c=Object.getPrototypeOf(b);if(c)return this===c||Object.getPrototypeOf(this)===c}}var d;for(var e in this)d=e;return a.undefined(d)||this.hasOwnProperty(d)})},a.date=function(){return a._every(arguments,function(){return"object"==typeof this&&a._isToString(this,"date")||!1})},a.regexp=function(){return a._every(arguments,function(){return(a.function(this)||"object"==typeof this)&&a._isToString(this,"regexp")||!1})},a.type=function(){var b,c=arguments;return["string","number","nan","boolean","null","undefined","array","argument","native","function","map","date","regexp"].some(function(d){return a[d](c[0])?(b=d,!0):!1}),a._every(c,function(c){return a[b](c)})?b:"mixed"},a.every=function(){return"mixed"!==a.type.apply(this,arguments)},a._primitive=function(b,c){return a._every(b,function(){return typeof this===c||"object"==typeof this&&a._isToString(this,c)||!1})},a._every=function(a,b){return Object.keys(a).every(function(c){return b.call(a[c],a[c])})},a._isToString=function(b,c){return a.toString.call(b)===a.class[c]},a}.call(a),f=function(a){function b(){}return b.escape=function(a){var b={"\\":"\\",'"':'"',"'":"'","\n":"n","\r":"r","	":"t","\u2028":"u2028","\u2029":"u2029"};return a.replace(/["'\n\r\t\u2028\u2029\\]/g,function(a){return"\\"+b[a]})},b.htmlEscape=function(a){var b={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};return a.replace(/[&<>"']/g,function(a){return b[a]})},b.unHtmlEscape=function(a){var b={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"};return a.replace(/&amp;|&lt;|&gt;|&quot;|&#39;/g,function(a){return b[a]})},b.collapse=function(a){return a.replace(/\s+/g," ")},b.stripTags=function(a){return a.replace(/<\/?[^>]+>/gi,"")},b.upper=function(a,b){return this._changeCase("toUpperCase",a,b)},b.lower=function(a,b){return this._changeCase("toLowerCase",a,b)},b._changeCase=function(b,c,d){return a.undefined(d)?c[b]():c.slice(0,d)+c.charAt(d)[b]()+c.slice(d+1)},b.repeat=function(a,b,c){return c=c||"",new Array(b+1).join(c+a).slice(c.length)},b}.call(a,e),g=function(a){function b(){}return b.random=function(b,c,d){return a.undefined(b)&&a.undefined(c)?Math.random():a.undefined(d)?Math.random()*(c-b)+b:Math.floor(Math.random()*(c-b)/d)*d+b},b}.call(a,e),h=function(a){function b(){}return b.extend=function(a){return[].slice.call(arguments,1).reduce(function(a,b){return Object.keys(b).reduce(function(a,c){return a[c]=b[c],a},a)},a)},b.deepExtend=function(c){return[].slice.call(arguments,1).reduce(function(b,d){return Object.keys(d).reduce(function(c,e){var f=c[e],g=d[e],h=a.map(g);return c[e]=a.map(f)&&h?this.deepExtend(f,g):h?b.clone(g):g,c}.bind(this),c)}.bind(this),b)},b.isEmpty=function(a){return!Object.keys(a||{}).length},b.clone=function(a){return b.extend({},a)},b.deepClone=function(a){return b.deepExtend({},a)},b}.call(a,e),i=function(a,b,c,d){function e(){this._custom={}}return e.idPrefix="i",e.idSalt=b.random(1e3,9999,1),e._id=0,e.resetId=function(){return e._id=0,e},e.prototype={get:function(){return c.extend(this._getConstructor(),this._getHelpers(),this._custom)},add:function(a,b){return this._custom[a]=b,this},_getConstructor:function(){return{__constructor:function(a,b){this.bemjson=a,this.data=c.extend({index:0,length:1},b||{}),this.construct.call(this,a,this.data)},construct:function(){}}},_getHelpers:function(){return c.extend({isFirst:function(){return 0===this.data.index},isLast:function(){return this.data.index+1===this.data.length},isElem:function(){return!!this.bemjson.elem},isBlock:function(){return!this.isElem()},id:function(a){return(a||e.idPrefix)+e.idSalt+e._id++}},this._getHelpersFromModule(a,["escape","htmlEscape","unHtmlEscape","collapse","stripTags","upper","lower","repeat"]),this._getHelpersFromModule(b,["random"]),this._getHelpersFromModule(c,["extend","deepExtend","clone","deepClone"]),{is:this._getHelpersFromModule(d,["string","boolean","number","integer","float","nan","null","undefined","primitive","array","argument","function","native","map","date","regexp","type","every"])})},_getHelpersFromModule:function(a,b){return b.reduce(function(b,c){return b[c]=function(){return a[c].apply(this,arguments)}.bind(a),b},{})}},e}.call(a,f,g,h,e),j=function(){function a(a){this._name=a||"",this._block="",this._modName="",this._modVal="",this._elem="",this._elemModName="",this._elemModVal="",this.info()}return a.delimiters={mod:"_",elem:"__"},a.prototype={info:function(){var a=this._getBlockAndElem(),b=this._getObjectAndMods(a.block),c=this._getObjectAndMods(a.elem);return{block:this._block=b.object,modName:this._modName=b.modName,modVal:this._modVal=b.modVal,elem:this._elem=c.object,elemModName:this._elemModName=c.modName,elemModVal:this._elemModVal=c.modVal}},isBlock:function(){return!this.isElem()},isElem:function(){return!!this._elem},block:function(a){return this._getSet("_block",a)},mod:function(a,c){return a===b&&c===b?{name:this.modName(),val:this.modVal()}:(this.modName(a),this.modVal(c),this)},modName:function(a){return this._getSet("_modName",a)},modVal:function(a){return this._getSet("_modVal",a)},elem:function(a){return this._getSet("_elem",a)},elemMod:function(a,c){return a===b&&c===b?{name:this.elemModName(),val:this.elemModVal()}:(this.elemModName(a),this.elemModVal(c),this)},elemModName:function(a){return this._getSet("_elemModName",a)},elemModVal:function(a){return this._getSet("_elemModVal",a)},toString:function(){var b=a.delimiters.mod,c=[this._block];return this._modName&&(c.push(b,this._modName),this._modVal&&this._modVal!==!0&&c.push(b,this._modVal)),this._elem&&(c.push(a.delimiters.elem,this._elem),this._elemModName&&(c.push(b,this._elemModName),this._elemModVal&&this._elemModVal!==!0&&c.push(b,this._elemModVal))),c.join("")},_getBlockAndElem:function(){var b=this._name.split(a.delimiters.elem);return{block:b[0]||"",elem:b[1]||""}},_getObjectAndMods:function(b){var c=b.split(a.delimiters.mod);return{object:c[0],modName:c[1]||"",modVal:c[2]||""}},_getSet:function(a,c){return c===b?this[a]:(this[a]=c,this)}},a}.call(a),k=function(a,b,c){function d(b){this._pattern=new a(b)}return d.any="*",d.prototype={is:function(a){return this[c.string(a)?"_isName":"_isNode"](a)},equal:function(a){return this[c.string(a)?"_equalName":"_equalNode"](a)},_name:function(b,c){b=new a(b);var d={};d[b.modName()]=b.modVal();var e={};return e[b.elemModName()]=b.elemModVal(),this[c]({block:b.block(),mods:d,elem:b.elem(),elemMods:e})},_isName:function(a){return this._name(a,"_isNode")},_isNode:function(a){return this._block(a.block)&&this._blockMod(a.mods)&&this._elem(a.elem)&&this._elemMod(a.elemMods)},_equalName:function(a){return this._name(a,"_equalNode")},_equalNode:function(a){return this._block(a.block)&&this._equalBlockMod(a.mods)&&this._elem(a.elem)&&this._equalElemMod(a.elemMods)},_block:function(a){var b=this._pattern.block();return b===d.any||a===d.any||b===a},_blockMod:function(a){return!this._pattern.isBlock()||this._pattern.modName()||this._pattern.modVal()?this._equalBlockMod(a):!0},_equalBlockMod:function(a){return this._anyMod(this._pattern.modName(),this._pattern.modVal(),a)},_elem:function(a){var b=this._pattern.elem();return b||a?b===d.any||a===d.any||b===a:!0},_elemMod:function(a){return!this._pattern.isElem()||this._pattern.elemModName()||this._pattern.elemModVal()?this._equalElemMod(a):!0},_equalElemMod:function(a){return this._anyMod(this._pattern.elemModName(),this._pattern.elemModVal(),a)},_anyMod:function(a,c,d){return a||d?d?b.isEmpty(d)||Object.keys(d).some(function(b){return this._mod(a,c,b,d[b])},this):!1:!0},_mod:function(a,b,c,e){return a===d.any&&b===d.any||c===d.any&&e===d.any?!0:a===d.any?e===d.any||b===e:c===d.any?b===d.any||b===e:b===d.any||!b&&e===!0?c===d.any||a===c:e===d.any?a===d.any||a===c:a===c&&b===e}},d}.call(a,j,h,e),l=function(a,c){function d(a){this._name=a||d.defaultName,this._class=[],this._attr={},this._single,this._content=[]}return d.defaultName="div",d.singleTags=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","wbr"],d.prototype={name:function(a){return a?(this._name=a,this):this._name},addClass:function(a){var b=Array.isArray(a)?a:[a];return b.forEach(function(a){this.hasClass(a)||this._class.push(a)},this),this},hasClass:function(a){return!!~this._class.indexOf(a)},delClass:function(a){var b=this._class.indexOf(a);return~b&&this._class.splice(b,1),this},getClass:function(){return this._class},single:function(a){return a===b?this._single!==b?this._single:!!~d.singleTags.indexOf(this._name):(this._single=a,this)},attr:function(d,e){return arguments.length?c.map(d)?(Object.keys(d).forEach(function(a){this.attr(a,d[a])},this),this):e===b?this._attr[d]:((c.array(e)||c.map(e))&&(e=a.htmlEscape(JSON.stringify(e))),this._attr[d]=e,this):this._attr},delAttr:function(a){return delete this._attr[a],this},content:function(a){return a===b?this._content:(this._content=[],this.addContent(a),this)},addContent:function(a){return Array.isArray(a)?this._content=this._content.concat(a):this._content.push(a),this},toString:function(){var a=["<"+this.name()],b=this.getClass(),c=this.attr();return b.length&&a.push(' class="'+b.join(" ")+'"'),Object.keys(c).forEach(function(b){a.push(" "+b+'="'+c[b]+'"')},this),this.single()?a.push("/>"):(a.push(">"),a=a.concat(this.content()),a.push("</"+this.name()+">")),a.join("")}},d}.call(a,f,e),m=function(a,c,d){function e(b){this._node=b,this._tag=new a(b.tag).attr(b.attrs||{}),this._name=this.getName(),this._mix=this.getMix(),this._params=this.getParams()}return e.bemClass="i-bem",e.bemAttr="data-bem",e.prototype={isBlock:function(){return!this.isElem()},isElem:function(){return!!this._node.elem},getName:function(){var a=new c(this._node.block);return this.isElem()&&a.elem(this._node.elem),a},getParams:function(){var a={};return this._node.js&&(a[this._name.toString()]=this._node.js===!0?{}:this._node.js),this._mix.reduce(function(a,b){return d.extend(a,b.params)},a)},getMix:function(){return this._node.mix?this._node.mix.reduce(function(a,b){if(!b)return a;var c=new e(b);return a.push({name:c.getName().toString(),params:c.getParams(),classes:c.getClass()}),a},[]):[]},getClass:function(){var a=this._node;return a.cls&&this._tag.addClass(a.cls.split(" ").filter(function(a){return a})),a.bem===!1?this._tag.getClass():((this.isBlock()||this.isElem()&&d.isEmpty(a.mods))&&this._tag.addClass(this._name.toString()),d.isEmpty(this._params)||this._tag.addClass(e.bemClass),d.isEmpty(a.mods)||this._tag.addClass(this._getModsClasses("mod")),this.isElem()&&!d.isEmpty(a.elemMods)&&this._tag.addClass(this._getElemModsClasses()),this._tag.addClass(this._mix.reduce(function(a,b){return a.concat(b.classes)},[])),this._tag.getClass())},content:function(a){return a===b?this._node.content||"":(this._node.content=a,this)},toString:function(){return this.getClass(),d.isEmpty(this._params)||this._tag.attr(e.bemAttr,this._params),this._node.content&&this._tag.addContent(this._node.content),this._tag.toString()},_getModsClasses:function(a){var b=this._node[a+"s"];return Object.keys(b).reduce(function(c,d){return c.push(this._name[a](d,b[d]).toString()),c}.bind(this),[])},_getElemModsClasses:function(){return d.isEmpty(this._node.mods)?this._getModsClasses("elemMod"):Object.keys(this._node.mods).reduce(function(a,b){return this._name.mod(b,this._node.mods[b]),a.concat(this._getModsClasses("elemMod"))}.bind(this),[])}},e}.call(a,l,j,h),n=function(){function a(){this.pool=[]}return a.prototype={add:function(){var a=arguments,b=Object.keys(a).reduce(function(b,c){return b.concat(a[c].split())},[]);return b.forEach(function(a){var b=this.is(a);this.pool.push(b?this.pool[b[0]].extend(a):a)},this),this},is:function(a){var b=[];return a.split().forEach(function(a){for(var c=this.pool.length-1;c>=0;c--)if(this.pool[c].is(a)){b.push(c);break}},this),b.length?b:null},find:function(a,b){for(var c=this.pool.length-1;c>=0;c--){var d=this.pool[c].match(a,b);if(d)return d}return null},clean:function(){return this.pool=[],this}},a}.call(a),o=function(a){return a}.call(a,d),p=function(a,b,c,d,e,f,g,h){function i(){this._patterns=[].slice.call(arguments,0,-1),this._modes=[].slice.call(arguments,-1)[0],this._helpers=new e,this._matches=Object.keys(this._patterns).reduce(function(b,c){return b.push(new a(this._patterns[c])),b}.bind(this),[]),this.Modes=this._classifyModes()}return i.tag="div",i.base=function(a,b){return new i(new c(a).isBlock()?"*":"*"+d.delimiters.elem+"*",{}).transform(a,b)},i.prototype={match:function(a,b){for(var c=0;c<this._matches.length;c++)if(this._matches[c].is(a))return this.transform(a,b);return null},transform:function(a,b){var d=new this.Modes(a,b);return Object.keys(this._getDefaultModes()).forEach(function(b){a[b]=this._getMode(d,a,b)},this),new c(a)},extend:function(a){return a.Modes=b(this.Modes,a._modes),a},split:function(){return Object.keys(this._patterns).reduce(function(a,b){return a.push(new i(this._patterns[b],this._modes).helper(this._helpers.get())),a}.bind(this),[])},is:function(a){return this._matches.some(function(b){return Object.keys(a._patterns).some(function(c){return b.is(a._patterns[c])})})},helper:function(a,b){return h.string(a)?this._helpers.add(a,b):Object.keys(a).forEach(function(b){this._helpers.add(b,a[b])},this),this.Modes=this._classifyModes(),this},_classifyModes:function(){return b(b(this._getBaseProps()),this._modes)},_getBaseProps:function(){return f.extend(this._getDefaultModes(),this._helpers.get())},_getDefaultModes:function(){var a=this._patterns.some(function(a){return new d(a).isBlock()},this);return{js:a,bem:!0,mods:{},elemMods:{},attrs:{},mix:[],tag:i.tag,cls:"",content:""}},_getMode:function(a,b,c){var d=h.function(a[c]),e=b[c],i=d?a[c].call(a,e):a[c],j=this._getPriorityValue(d,i,e);return h.array(i,e)?e.concat(i):h.map(i,e)?d?f.extend(e,i):f.extend(f.clone(i),e):"content"===c&&h.string(j)?g.htmlEscape(j):j},_getPriorityValue:function(a,b,c){return a?b:h.undefined(c)?b:c}},i}.call(a,k,o,m,j,i,h,f,e),q=function(a,b,c){function d(a,b){this._tree=a,this._pool=b,this._block=a.block||""}return d.prototype={expand:function(a){return this._getNode(a)},toString:function(){return this.expand(this._tree).toString()},_getContent:function(a,c){return b.array(a)?a.reduce(function(b,d,e){var f={index:e,length:a.length};return d&&d.elem&&(f.context=c.context),b.push(this._getNode(d,f)),b}.bind(this),[]):this._getNode(a,c)},_getNode:function(d,e){if(b.map(d)){d.elem&&!d.block&&e.context.block&&(d.block=e.context.block,e.context.mods&&(d.mods=c.extend(d.mods||{},e.context.mods)));var f=this._pool.find(d,e)||a.base(d,e),e={};return d.block&&(e.context={block:d.block},d.mods&&(e.context.mods=d.mods)),f.content(this._getContent(d.content,e)),f}return d}},d}.call(a,p,e,h),r=function(){function a(){}return a.apply=function(a,b){function c(){return a.apply(this,b)}return c.prototype=a.prototype,new c},a}.call(a);c.export("bemer",function(a,b,c,d,e,f,g,h){function i(b){return new a(b,j).toString()}var j=new c,k={};i.match=function(){return j.add(d.apply(b,arguments).helper(k)),this},i.clean=function(){return j.clean(),h.resetId(),this},i.helper=function(a,b){return k[a]=b,this};var l={delimiters:{mod:e.delimiters.mod,elem:e.delimiters.elem},tag:b.tag,bemClass:f.bemClass,bemAttr:f.bemAttr,idPrefix:h.idPrefix};return i.config=function(a){return a=a||l,a.delimiters&&g.extend(e.delimiters,a.delimiters),a.tag&&(b.tag=a.tag),a.bemClass&&(f.bemClass=a.bemClass),a.bemAttr&&(f.bemAttr=a.bemAttr),a.idPrefix&&(h.idPrefix=a.idPrefix),this},i}.call(a,q,p,n,r,j,m,h,i))}["inherit"].forEach(function(b){delete a[b]})}(this);