(function(a){var b=a,c=a,d=a;!function(a){function e(a){var b=m(a);if(s)for(var c,d=0;c=v[d++];)a.hasOwnProperty(c)&&b.push(c);return b}function f(a,b,c){for(var d,f,g=e(c),h=0,j=g.length;j>h;)"__self"!==(d=g[h++])&&(f=c[d],q(f)&&(!i||f.toString().indexOf(".__base")>-1)?b[d]=function(b,c){var d=a[b]||r;return function(){var a=this.__base;this.__base=d;var b=c.apply(this,arguments);return this.__base=a,b}}(d,f):b[d]=f)}function g(a,b){for(var c,d=1;c=a[d++];)b?q(c)?h.self(b,c.prototype,c):h.self(b,c):b=q(c)?h(a[0],c.prototype,c):h(a[0],c);return b||a[0]}function h(){var a=arguments,b=p(a[0]),c=b||q(a[0]),d=c?b?g(a[0]):a[0]:j,e=a[c?1:0]||{},h=a[c?2:1],i=e.__constructor||c&&d.prototype.__constructor?function(){return this.__constructor.apply(this,arguments)}:function(){};if(!c)return i.prototype=e,i.prototype.__self=i.prototype.constructor=i,n(i,h);n(i,d);var k=d.prototype,m=i.prototype=l(k);return m.__self=m.constructor=i,e&&f(k,m,e),h&&f(d,i,h),i}var i=function(){"_"}.toString().indexOf("_")>-1,j=function(){},k=Object.prototype.hasOwnProperty,l=Object.create||function(a){var b=function(){};return b.prototype=a,new b},m=Object.keys||function(a){var b=[];for(var c in a)k.call(a,c)&&b.push(c);return b},n=function(a,b){for(var c in b)k.call(b,c)&&(a[c]=b[c]);return a},o=Object.prototype.toString,p=Array.isArray||function(a){return"[object Array]"===o.call(a)},q=function(a){return"[object Function]"===o.call(a)},r=function(){},s=!0,t={toString:""};for(var u in t)t.hasOwnProperty(u)&&(s=!1);var v=s?["toString","valueOf"]:null;h.self=function(){var a=arguments,b=p(a[0]),c=b?g(a[0],a[0][0]):a[0],d=a[1],e=a[2],h=c.prototype;return d&&f(h,h,d),e&&f(c,c,e),c};var w=!0;"object"==typeof b&&(module.exports=h,w=!1),"object"==typeof c&&(c.define("inherit",function(a){a(h)}),w=!1),"function"==typeof d&&(d(function(a,b,c){c.exports=h}),w=!1),w&&(a.inherit=h)}(this)}).call(this),/*!
 * @file Template engine. BEMJSON to HTML processor.
 * @copyright 2014 Artem Kurbatov, tenorok.ru
 * @license MIT license
 * @version 0.8.5
 * @date 6 March 2016
 */
function(a,b){var c={"export":function(b,c){return"object"==typeof exports?module.exports[b]=c:a[b]=c}},d=a.inherit,e=function(){function a(){}return a["class"]={string:"[object String]",number:"[object Number]","boolean":"[object Boolean]",array:"[object Array]",object:"[object Object]",func:"[object Function]",date:"[object Date]",regexp:"[object RegExp]",arguments:"[object Arguments]",error:"[object Error]"},a.toString=Object.prototype.toString,a.reNative=RegExp("^"+String(a.toString).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$"),a.string=function(b){return a._primitive(arguments,"string")},a.number=function(b){return!a.nan.apply(this,arguments)&&a._primitive(arguments,"number")},a.integer=function(b){return a.number.apply(this,arguments)&&a._every(arguments,function(){return this%1===0})},a["float"]=function(b){return a.number.apply(this,arguments)&&a._every(arguments,function(){return this%1!==0})},a.nan=function(b){return a._every(arguments,function(b){return"number"==typeof b&&isNaN(b)&&!a.undefined(b)})},a["boolean"]=function(b){return a._primitive(arguments,"boolean")},a["null"]=function(b){return a._every(arguments,function(a){return null===a})},a.undefined=function(b){return a._every(arguments,function(a){return"undefined"==typeof a})},a.primitive=function(b){return a._every(arguments,function(b){return a.string(b)||a.number(b)||a.nan(b)||a["boolean"](b)||a["null"](b)||a.undefined(b)})},a.array=function(b){return a._every(arguments,function(){return Array.isArray(this)})},a.argument=function(b){return a._every(arguments,function(){return"object"==typeof this&&"number"==typeof this.length&&a._isToString(this,"arguments")||!1})},a["function"]=function(b){return a._every(arguments,function(){return"function"==typeof this})},a["native"]=function(b){return a._every(arguments,function(){return a["function"](this)&&a.reNative.test(this)})},a.map=function(b){return a._every(arguments,function(){if(!a._isToString(this,"object")||a.argument(this))return!1;if(a["native"](this.valueOf)){var b=Object.getPrototypeOf(this.valueOf);if(b){var c=Object.getPrototypeOf(b);if(c)return this===c||Object.getPrototypeOf(this)===c}}var d=Object.keys(this),e=d[d.length-1];return a.undefined(e)||this.hasOwnProperty(e)})},a.date=function(b){return a._every(arguments,function(){return"object"==typeof this&&a._isToString(this,"date")||!1})},a.regexp=function(b){return a._every(arguments,function(){return(a["function"](this)||"object"==typeof this)&&a._isToString(this,"regexp")||!1})},a.type=function(b){for(var c,d=["string","number","nan","boolean","null","undefined","array","argument","native","function","map","date","regexp"],e=0,f=d.length;f>e;e++){var g=d[e];if(a[g](arguments[0])){c=g;break}}return a._every(arguments,function(b){return a[c](b)})?c:"mixed"},a.every=function(b){return"mixed"!==a.type.apply(this,arguments)},a._primitive=function(b,c){return a._every(b,function(){return typeof this===c||"object"==typeof this&&a._isToString(this,c)||!1})},a._every=function(a,b){for(var c=0,d=a.length;d>c;c++){var e=a[c];if(!b.call(e,e))return!1}return!0},a._isToString=function(b,c){return a.toString.call(b)===a["class"][c]},a}.call(a),f=function(a){function b(){}return b.escape=function(a){var b={"\\":"\\",'"':'"',"'":"'","\n":"n","\r":"r","	":"t","\u2028":"u2028","\u2029":"u2029"};return a.replace(/["'\n\r\t\u2028\u2029\\]/g,function(a){return"\\"+b[a]})},b.unEscape=function(a){var b={"\\\\":"\\",'\\"':'"',"\\'":"'","\\n":"\n","\\r":"\r","\\t":"	","\\u2028":"\u2028","\\u2029":"\u2029"};return a.replace(/\\"|\\'|\\n|\\r|\\t|\\u2028|\\u2029|\\\\/g,function(a){return b[a]})},b.htmlEscape=function(a){var b={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};return a.replace(/[&<>"']/g,function(a){return b[a]})},b.unHtmlEscape=function(a){var b={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"};return a.replace(/&amp;|&lt;|&gt;|&quot;|&#39;/g,function(a){return b[a]})},b.collapse=function(a){return a.replace(/\s+/g," ")},b.stripTags=function(a){return a.replace(/<\/?[^>]+>/gi,"")},b.upper=function(a,b,c){return this._changeCase("toUpperCase",a,b,c)},b.lower=function(a,b,c){return this._changeCase("toLowerCase",a,b,c)},b._changeCase=function(b,c,d,e){return a.undefined(d)?c[b]():a.undefined(e)?c.slice(0,d)+c.charAt(d)[b]()+c.substring(d+1):c.slice(0,d)+c.substring(d,e)[b]()+c.substring(e)},b.repeat=function(a,b,c){return c=c||"",new Array(b+1).join(c+a).slice(c.length)},b}.call(a,e),g=function(a){function b(){}return b.random=function(b,c,d){return a.undefined(b)&&a.undefined(c)?Math.random():a.undefined(d)?Math.random()*(c-b)+b:Math.floor(Math.random()*(c-b)/d)*d+b},b}.call(a,e),h=function(a){function c(){}return c.isNeedHasOwnProperty=function(a){for(b in{})return!0;for(var b in Object.getPrototypeOf(a))return!0;return!1},c.extend=function(a,b){for(var c=1,d=arguments.length;d>c;c++){var e,f=arguments[c];if(this.isNeedHasOwnProperty(f))for(e in f)this.hasOwnProperty(f,e)&&(a[e]=f[e]);else for(e in f)a[e]=f[e]}return a},c.deepExtend=function(b,c){for(var d=1,e=arguments.length;e>d;d++)this.each(arguments[d],function(c,d){var e=b[c],f=a.map(d);a.map(e)&&f?b[c]=this.deepExtend(e,d):f?b[c]=this.deepClone(d):b[c]=d},this);return b},c.isEmpty=function(a){a=a||{};var b=this.isNeedHasOwnProperty(a);for(var c in a)if(!b||a.hasOwnProperty(c))return!1;return!0},c.isEqual=function(a){for(var b=[].slice.call(arguments,1),c=this.size(a),d=0;d<b.length;d++){if(c!==this.size(b[d]))return!1;if(this.each(a,function(a,c){return c!==b[d][a]?!0:void 0}))return!1}return!0},c.isDeepEqual=function(b){for(var c=[].slice.call(arguments,1),d=0;d<c.length;d++){var e=c[d];if(a.map(b,e)){if(this.size(b)!==this.size(e))return!1;if(this.each(b,function(a,b){return this.isDeepEqual(b,e[a])?void 0:!0},this))return!1}else if(a.array(b,e)){if(b.length!==e.length)return!1;for(var f=0;f<b.length;f++)if(!this.isDeepEqual(b[f],e[f]))return!1}else if(b!==e)return!1}return!0},c.size=function(a){var b=0;return c.each(a,function(){b++}),b},c.clone=function(a){return this.extend({},a)},c.deepClone=function(a){return this.deepExtend({},a)},c.hasOwnProperty=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},c.each=function(a,c,d){var e,f;if(this.isNeedHasOwnProperty(a)){for(e in a)if(this.hasOwnProperty(a,e)&&(f=c.call(d||a,e,a[e],a),f!==b))return f}else for(e in a)if(f=c.call(d||a,e,a[e],a),f!==b)return f},c.deepEach=function(c,d,e){var f,g,h,i,j=this.isNeedHasOwnProperty(c);for(f in c)if(!j||c.hasOwnProperty(f))if(g=c[f],a.map(g)){if(i=this.deepEach(g,d,e),i!==b)return i}else if(h=d.call(e||c,f,g,c),h!==b)return h},c.map=function(a,b,c){return this.each(a,function(c){a[c]=b.apply(this,arguments)},c),a},c.deepMap=function(a,b,c){return this.deepEach(a,function(a,c,d){d[a]=b.apply(this,arguments)},c),a},c}.call(a,e),i=function(a,b,c,d){function e(){this._custom={}}return e.idPrefix="i",e.idSalt=b.random(1e3,9999,1),e._id=0,e.resetId=function(){return e._id=0,e},e.prototype={get:function(){return c.extend(this._getConstructor(),this._getHelpers(),this._custom)},add:function(a,b){return this._custom[a]=b,this},_getConstructor:function(){return{__constructor:function(a,b){this.bemjson=a,this.data=c.extend({index:0,length:1},b||{}),this.construct.call(this,a,this.data)},construct:function(a,b){}}},_getHelpers:function(){return c.extend({isFirst:function(){return 0===this.data.index},isLast:function(){return this.data.index+1===this.data.length},isElem:function(){return!!this.bemjson.elem},isBlock:function(){return!this.isElem()},id:function(a){return(a||e.idPrefix)+e.idSalt+e._id++}},this._getHelpersFromModule(a,["escape","unEscape","htmlEscape","unHtmlEscape","collapse","stripTags","upper","lower","repeat"]),this._getHelpersFromModule(b,["random"]),this._getHelpersFromModule(c,["extend","deepExtend","clone","deepClone"]),{is:this._getHelpersFromModule(d,["string","boolean","number","integer","float","nan","null","undefined","primitive","array","argument","function","native","map","date","regexp","type","every"])})},_getHelpersFromModule:function(a,b){return b.reduce(function(b,c){return b[c]=function(){return a[c].apply(this,arguments)}.bind(a),b},{})}},e}.call(a,f,g,h,e),j=function(a){function c(a){this._selector=a||"",this._block="",this._modName="",this._modVal="",this._elem="",this._elemModName="",this._elemModVal="",this._weight=0,this.info()}return c.delimiters={mod:"_",elem:"__"},c.any="*",c.prototype={info:function(){var a=this._getBlockAndElem(),b=this._getObjectAndMods(a.block),c=this._getObjectAndMods(a.elem);return{block:this._block||(this._block=b.object),modName:this._modName||(this._modName=b.modName),modVal:this._modVal||(this._modVal=b.modVal),elem:this._elem||(this._elem=c.object),elemModName:this._elemModName||(this._elemModName=c.modName),elemModVal:this._elemModVal||(this._elemModVal=c.modVal)}},isBlock:function(){return!!this._block&&!this.isElem()},isElem:function(){return!!this._elem},block:function(a){return this._getSet("_block",a)},mod:function(a,c){return a===b&&c===b?{name:this.modName(),val:this.modVal()}:(this.modName(a),this.modVal(c),this)},modName:function(a){return this._getSet("_modName",a)},modVal:function(a){return this._getSet("_modVal",a,!0)},elem:function(a){return this._getSet("_elem",a)},elemMod:function(a,c){return a===b&&c===b?{name:this.elemModName(),val:this.elemModVal()}:(this.elemModName(a),this.elemModVal(c),this)},elemModName:function(a){return this._getSet("_elemModName",a)},elemModVal:function(a){return this._getSet("_elemModVal",a,!0)},toString:function(){var a=[this._block].concat(this._getMod("_modName","_modVal"));return this._elem&&(a=a.concat(c.delimiters.elem,this._elem,this._getMod("_elemModName","_elemModVal"))),a.join("")},weight:function(a){if(a)return this._weight=a,this;if(this._weight)return this._weight;var b={block:2,modName:2,modVal:2,elem:10,elemModName:6,elemModVal:6};return["block","modName","modVal","elem","elemModName","elemModVal"].reduce(function(a,d){var e=this[d]();return e&&(a+=e===c.any?b[d]/2:b[d]),a}.bind(this),0)},_getBlockAndElem:function(){var a=this._selector.split(c.delimiters.elem);return{block:a[0]||"",elem:a[1]||""}},_getObjectAndMods:function(a){var b=a.split(c.delimiters.mod);return{object:b[0],modName:b[1]||"",modVal:b[2]||""}},_getMod:function(a,b){var d=[];return a=this[a],b=this[b],a&&b!==!1&&(d.push(c.delimiters.mod,a),b&&b!==!0&&d.push(c.delimiters.mod,b)),d},_getSet:function(c,d,e){return d===b?this[c]:(this[c]=e===!0&&a["boolean"](d)?d:String(d),this)}},c}.call(a,e),k=function(a,c,d){function e(b){this._pattern=new a(b)}return e.prototype={pattern:function(c){return c===b?this._pattern:(this._pattern=new a(c),this)},is:function(a){return this[d.string(a)?"_isName":"_isNode"](a)},equal:function(a){return this[d.string(a)?"_equalName":"_equalNode"](a)},_name:function(b,c){b=new a(b);var d={};d[b.modName()]=b.modVal();var e={};return e[b.elemModName()]=b.elemModVal(),this[c]({block:b.block(),mods:d,elem:b.elem(),elemMods:e})},_isName:function(a){return this._name(a,"_isNode")},_isNode:function(a){return this._block(a.block)&&this._blockMod(a.mods)&&this._elem(a.elem)&&this._elemMod(a.elemMods)},_equalName:function(a){return this._name(a,"_equalNode")},_equalNode:function(a){return this._block(a.block)&&this._equalBlockMod(a.mods)&&this._elem(a.elem)&&this._equalElemMod(a.elemMods)},_block:function(b){var c=this._pattern.block();return c===a.any||b===a.any||c===b},_blockMod:function(a){return this._pattern.modName()||this._pattern.modVal()?this._equalBlockMod(a):!0},_equalBlockMod:function(a){return this._anyMod(this._pattern.modName(),this._pattern.modVal(),a)},_elem:function(b){var c=this._pattern.elem();return b&&!c?!1:b?c===a.any||b===a.any||c===b:!c},_elemMod:function(a){return!this._pattern.isElem()||this._pattern.elemModName()||this._pattern.elemModVal()?this._equalElemMod(a):!0},_equalElemMod:function(a){return this._anyMod(this._pattern.elemModName(),this._pattern.elemModVal(),a)},_anyMod:function(a,b,d){return a||d&&!c.isEmpty(d)?d?Object.keys(d).some(function(c){return this._mod(a,b,c,d[c])},this):!1:!0},_mod:function(b,c,d,e){var f=a.any;return b===f&&c===f||d===f&&e===f?!0:b===f?e===f||c===e:d===f?c===f||c===e:c===f||!c&&e===!0?d===f||b===d:e===f?b===f||b===d:b===d&&c===e}},e}.call(a,j,h,e),l=function(a,c,d){function e(a){this._name=d.string(a)||a===!1?a:!0,this._class=[],this._attr={},this._single,this._content=[]}return e.defaultName="div",e.repeatBooleanAttr=!1,e.closeSingleTag=!1,e.escapeContent=!0,e.escapeAttr=!0,e.singleTags=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","wbr"],e.prototype={name:function(a){return a===b?this._name===!0?e.defaultName:this._name:(this._name=d.string(a)||a===!1?a:!0,this)},addClass:function(a){var b=d.array(a)?a:[a];return b.forEach(function(a){this.hasClass(a)||this._class.push(a)},this),this},hasClass:function(a){return!!~this._class.indexOf(a)},delClass:function(a){var b=this._class.indexOf(a);return~b&&this._class.splice(b,1),this},getClass:function(){return this._class},single:function(a){return a===b||d.string(a)?this._single!==b?this._single:!!~e.singleTags.indexOf(a||this._name):(this._single=a,this)},attr:function(a,e){return arguments.length?d.map(a)?(c.each(a,function(a,b){this.attr(a,b)},this),this):e===b?this._attr[a]:(e===!1?this.delAttr(a):this._attr[a]=e,this):this._attr},delAttr:function(a){return delete this._attr[a],this},content:function(a){return a===b?this._content:(this._content=[],this.addContent(a),this)},addContent:function(a){return this._content=this._content.concat(a),this},toString:function(b){if(this.name()===!1)return this.content().join("");b=c.extend({defaultName:e.defaultName,repeatBooleanAttr:e.repeatBooleanAttr,closeSingleTag:e.closeSingleTag,escapeContent:e.escapeContent,escapeAttr:e.escapeAttr},b||{});var f=this._name===!0?b.defaultName:this._name,g=["<"+f],h=this.getClass(),i=this.attr();return h.length&&g.push(' class="'+h.join(" ")+'"'),c.each(i,function(e,f){if(f===!0)return void g.push(" "+e+(b.repeatBooleanAttr?'="'+e+'"':""));var h=d.map(f);if(h&&"style"===e){var i=[];c.each(f,function(a,b){d.number(b)&&0!==b&&(b+="px"),a=a.replace(/([A-Z])/g,function(a,b){return"-"+b.toLowerCase()}),i.push(a+":"+b+";")}),f=i.join("")}else d.array(f)||h?f=a.htmlEscape(JSON.stringify(f)):b.escapeAttr&&d.string(f)&&(f=a.htmlEscape(f));g.push(" "+e+'="'+f+'"')}),this.single(f)?g.push(b.closeSingleTag?"/>":">"):(g.push(">"),g=g.concat(b.escapeContent?this.content().map(function(b){return d.string(b)?a.htmlEscape(b):b}):this.content()),g.push("</"+f+">")),g.join("")}},e}.call(a,f,h,e),m=function(a,c,d){function f(a){this._bemjson=a,this._setInfo(a)}return f.bemClass="i-bem",f.bemAttr="data-bem",f.prototype={bemjson:function(a){return a===b?this._bemjson:(this._bemjson=a,this._setInfo(a),this)},isBlock:function(){return!!this._bemjson.block&&!this.isElem()},isElem:function(){return!!this._bemjson.elem},getName:function(){var a=new c(this._bemjson.block);return this.isElem()&&a.elem(this._bemjson.elem),a},getParams:function(){var a={};return this._bemjson.js&&(a[this._name.toString()]=this._bemjson.js===!0?{}:this._bemjson.js),this._mix.reduce(function(a,b){return d.extend(a,b.params)},a)},getMix:function(){return this._bemjson.mix?this._bemjson.mix.reduce(function(a,b){if(!b)return a;var c=new f(b);if(c.isElem()&&!c.bemjson().block){var d=c.bemjson();d.block=this._bemjson.block,c.bemjson(d)}return a.push({name:c.getName().toString(),params:c.getParams(),classes:c.getClass()}),a}.bind(this),[]):[]},getClass:function(){var a=this._bemjson;if(a.cls&&this._tag.addClass(a.cls.split(" ").filter(function(a){return a})),a.bem===!1)return this._tag.getClass();if((this.isBlock()||this.isElem())&&this._tag.addClass(this._name.toString()),d.isEmpty(this._params)||this._tag.addClass(f.bemClass),!d.isEmpty(a.mods)){var b=this._getModsClasses("mod");this._tag.addClass(b.length?b:this._name.toString())}return this.isElem()&&!d.isEmpty(a.elemMods)&&this._tag.addClass(this._getElemModsClasses()),this._tag.addClass(this._mix.reduce(function(a,b){return a.concat(b.classes)},[])),this._tag.getClass()},content:function(a){return a===b?this._bemjson.content||"":(this._bemjson.content=a,this)},toString:function(){this.getClass(),d.isEmpty(this._params)||this._tag.attr(f.bemAttr,this._params),this._bemjson.content&&this._tag.addContent(this._bemjson.content);var a=f.resolveOptionEscape(this._options.escape);return this._tag.toString({escapeContent:a.content,escapeAttr:a.attrs})},_setInfo:function(c){this._tag=new a(c.tag).attr(c.attrs||{}),c.single!==b&&this._tag.single(c.single),this._name=this.getName(),this._mix=this.getMix(),this._params=this.getParams(),this._options=c.options||{}},_getModsClasses:function(a){var c=this._bemjson[a+"s"];return Object.keys(c).reduce(function(d,e){return c[e]!==!1&&c[e]!==b&&d.push(this._name[a](e,c[e]).toString()),d}.bind(this),[])},_getElemModsClasses:function(){this._name.modVal(!1);var a=this._getModsClasses("elemMod");return d.isEmpty(this._bemjson.mods)||(a=a.concat(Object.keys(this._bemjson.mods).reduce(function(a,b){return this._name.mod(b,this._bemjson.mods[b]),a.concat(this._getModsClasses("elemMod"))}.bind(this),[]))),a}},f.resolveOptionEscape=function(c){var d=a.escapeContent,f=a.escapeAttr;return c!==b&&(e["boolean"](c)?(d=c,f=c):(e["boolean"](c.content)&&(d=c.content),e["boolean"](c.attrs)&&(f=c.attrs))),{content:d,attrs:f}},f}.call(a,l,j,h),n=function(a,b){function c(){}return c.pushOnce=function(a,b){for(var c=Array.prototype.slice.call(arguments,1),d=0;d<c.length;d++)~a.indexOf(c[d])||a.push(c[d]);return a.length},c.concatOnce=function(b,c){for(var d=Array.prototype.slice.call(arguments,1),e=b.slice(),f=0;f<d.length;f++)if(a.array(d[f]))for(var g=0;g<d[f].length;g++)this.pushOnce(e,d[f][g]);else this.pushOnce(e,d[f]);return e},c.clone=function(a){return a.slice()},c.deepClone=function(d){for(var e=[],f=0,g=d.length;g>f;f++){var h=d[f];a.array(h)?h=c.deepClone(h):a.map(h)&&(h=b.deepClone(h)),e.push(h)}return e},c}.call(a,e,h),o=function(a,b){function c(){this.pool=[]}return c.prototype={add:function(a){var b=arguments,c=Object.keys(b).reduce(function(a,c){return a.concat(b[c].split())},[]);return c.forEach(function(a){var b=this.is(a);this.pool.push(b?this.pool[b[0]].extend(a):a)},this),this},is:function(a){var b=[];return a.split().forEach(function(a){for(var c=this.pool.length-1;c>=0;c--)if(this.pool[c].is(a)){b.push(c);break}},this),b.length?b:null},find:function(a,c){for(var d=null,e=null,f=a,g=[],h={},i=this.pool.length-1;i>=0;i--)~g.indexOf(this.pool[i])||(d&&(f=d.bemjson()),e=this.pool[i].match(f,c,a,h,i),e&&(d=e,g.push(this.pool[i]),b.isEqual(f.mods||{},d.bemjson().mods)&&b.isEqual(f.elemMods||{},d.bemjson().elemMods)||(i=this.pool.length)));return d},clean:function(){return this.pool=[],this}},c}.call(a,n,h),p=function(a){return a}.call(a,d),q=function(a,c,d,e,f,g,h,i,j){function k(b,c){this._patterns=[].slice.call(arguments,0,-1),this.modes=[].slice.call(arguments,-1)[0],this._modesNames=Object.keys(this.modes),this.weight=1===this._patterns.length?new e(this._patterns[0]).weight():null,this._helpers=new f,this._matches=Object.keys(this._patterns).map(function(b){return new a(this._patterns[b])},this),this.Modes=this._classifyModes()}return k.base=function(a,b){return k.baseTemplate.transform(a,b)},k.prototype={match:function(a,b,c,d,e){for(var f=0;f<this._matches.length;f++)if(this._matches[f].is(a))return this.transform(g.clone(a),b,c,d,e);return null},transform:function(a,b,c,e,f){for(var g=new this.Modes(a,b),h=0,i=k._defaultModesNames.length;i>h;h++){var j=k._defaultModesNames[h];a[j]=this._getMode(g,a,j,c||a,e||{},f||0)}return new d(a)},extend:function(a){return a.Modes=c(this.Modes,a.modes),a},split:function(){return Object.keys(this._patterns).map(function(a){return new k(this._patterns[a],this.modes).helper(this._helpers.get())},this)},is:function(a){return this._matches.some(function(b){return Object.keys(a._patterns).some(function(c){return b.is(a._patterns[c])})})},helper:function(a,b){return j.string(a)?this._helpers.add(a,b):g.each(a,function(a,b){this._helpers.add(a,b)},this),this.Modes=this._classifyModes(),this},_classifyModes:function(){return c(c(this._getBaseModes()),this._functionifyModes(this.modes))},_getBaseModes:function(){return g.extend(this._functionifyModes(this._getDefaultModes()),this._helpers.get())},_functionifyModes:function(a){return g.each(a,function(b,c){j["function"](c)||(a[b]=function(){return j.array(c)?h.deepClone(c):j.map(c)?g.deepClone(c):c},a[b].__wrapped__=!0)},this),a},_getDefaultModes:function(){return{js:!1,bem:!0,mods:{},elemMods:{},attrs:{},mix:[],tag:!0,single:b,cls:"",content:"",options:{}}},_getMode:function(a,b,c,d,e,f){var h=!a[c].__wrapped__,i=b[c],k=d[c],l=a[c].call(a,i),m=this._getPriorityValue(c,l,i,k,h,e,{weight:this.weight,index:f});return h||(j.array(l,i)?m=i.concat(l):j.map(l,i)&&(m=this._isThisTemplatePriority(f,e[c],h)?g.extend(g.clone(i),l):g.extend(g.clone(l),i))),m},_getPriorityValue:function(a,b,c,d,e,f,g){var h=!!~this._modesNames.indexOf(a),i=this._isThisTemplatePriority(g.index,f[a],e);return i&&h?(f[a]=g,b):f[a]||j.undefined(d)?j.undefined(b)||f[a]&&(!h||!i)?c:(h&&(f[a]=g),b):d},_isThisTemplatePriority:function(a,b,c){return b?b.weight>this.weight?!1:b.weight===this.weight?b.index<=a:!0:c}},k.baseTemplate=new k("",{}),k._defaultModes=k.baseTemplate._getDefaultModes(),k._defaultModesNames=Object.keys(k._defaultModes),k}.call(a,k,p,m,j,i,h,n,f,e),r=function(a,c,d){function e(a,b){this._tree=a,this._pool=b}return e.prototype={expand:function(a){return this._getNode(a)},toString:function(){return this.expand(this._tree).toString()},_getContentList:function(a,b,d){for(var e=[],f=0,g=a.length;g>f;f++){var h=a[f],i={index:f,length:a.length};h&&(i.context=b.context);var j=c.array(h)?this._getContentList(h,b,d):this._getNode(h,i,d);e=e.concat(j)}return e},_getNode:function(e,f,g){if(!c.map(e))return e===b?"":e;f=f||{},g=g||{},!e.block&&e.elem&&(e.block=g.block,e.mods=d.extend(d.clone(g.mods),e.mods||{}));var h=this._pool.find(e,f)||a.base(e,f),i=h.bemjson();return i.block&&(f.context={block:i.block,mods:d.clone(i.mods)},h.isBlock()?g={block:f.context.block,mods:f.context.mods}:(f.context.elem=i.elem,f.context.elemMods=i.elemMods)),h.content(this[c.array(i.content)?"_getContentList":"_getNode"](i.content,f,g))}},e}.call(a,q,e,h),s=function(){function a(){}return a.apply=function(a,b){function c(){return a.apply(this,b)}return c.prototype=a.prototype,new c},a}.call(a),t=function(a,b,c,d){function e(){}return e._list={Tag:a,Selector:b,Node:c,Match:d},e.get=function(a){return a?e._list[a]:e._list},e}.call(a,l,j,m,k);c["export"]("bemer",function(a,c,d,e,f,g,h,i,j,k,l){function m(a){return new c(a,n).toString()}var n=new e,o={};m.match=function(a,b){return n.add(i.apply(d,arguments).helper(o)),this},m.clean=function(){return n.clean(),h.resetId(),this},m.helper=function(a,b){return o[a]=b,this};var p={delimiters:{mod:f.delimiters.mod,elem:f.delimiters.elem},xhtml:{repeatBooleanAttr:a.repeatBooleanAttr,closeSingleTag:a.closeSingleTag},escape:{content:a.escapeContent,attr:a.escapeAttr},tag:a.defaultName,bemClass:g.bemClass,bemAttr:g.bemAttr,idPrefix:h.idPrefix};return m.config=function(c){c=c||p,c.delimiters&&j.extend(f.delimiters,c.delimiters),c.xhtml!==b&&(k["boolean"](c.xhtml)?(a.repeatBooleanAttr=c.xhtml,a.closeSingleTag=c.xhtml):(k["boolean"](c.xhtml.repeatBooleanAttr)&&(a.repeatBooleanAttr=c.xhtml.repeatBooleanAttr),k["boolean"](c.xhtml.closeSingleTag)&&(a.closeSingleTag=c.xhtml.closeSingleTag)));var d=g.resolveOptionEscape(c.escape);return a.escapeContent=d.content,a.escapeAttr=d.attrs,c.tag&&(a.defaultName=c.tag),c.bemClass&&(g.bemClass=c.bemClass),c.bemAttr&&(g.bemAttr=c.bemAttr),c.idPrefix&&(h.idPrefix=c.idPrefix),this},m.modules=function(a){return l.get(a)},m}.call(a,l,r,q,o,j,m,i,s,h,e,t)),c["export"]("molotok",function(a,b,c,d,e,f){return{is:a,string:b,number:c,array:d,object:e,functions:f}}.call(a,e,f,g,n,h,s));["inherit"].forEach(function(b){delete a[b]})}(this);